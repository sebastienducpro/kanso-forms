<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audit Kanso 360 - Entretien Client v10</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --violet-primary: #8B5CF6;
            --violet-dark: #6D28D9;
            --violet-glow: rgba(139, 92, 246, 0.4);
            --noir-deep: #0D0D15;
            --noir-card: #1A1A2E;
            --noir-input: #252538;
            --gris-text: #A0A0B2;
            --gris-border: #3A3A50;
            --blanc: #FFFFFF;
            --rouge: #EF4444;
            --vert: #10B981;
            --jaune: #F59E0B;
            --bleu: #3B82F6;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: var(--noir-deep);
            color: var(--blanc);
            min-height: 100vh;
            padding: 40px 20px;
        }

        .container { max-width: 900px; margin: 0 auto; }

        .header { text-align: center; margin-bottom: 40px; }
        .header h1 { font-size: 2.5rem; font-weight: 800; color: var(--vert); margin-bottom: 12px; }
        .header p { font-size: 1.1rem; color: var(--gris-text); }

        .badge {
            display: inline-block;
            background: rgba(16, 185, 129, 0.15);
            border: 1px solid var(--vert);
            color: var(--vert);
            padding: 8px 20px;
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 500;
            margin-bottom: 20px;
        }

        .timer-bar {
            display: flex; justify-content: space-between; align-items: center;
            background: var(--noir-card); border: 1px solid var(--gris-border);
            border-radius: 10px; padding: 12px 20px; margin-bottom: 20px;
        }
        .timer { font-size: 1.2rem; font-weight: 600; color: var(--vert); }
        .timer-label { color: var(--gris-text); font-size: 0.85rem; }

        .progress-container { margin-bottom: 30px; }
        .progress-bar { height: 6px; background: var(--gris-border); border-radius: 3px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--vert), #34D399); transition: width 0.3s ease; }

        .form-card {
            background: var(--noir-card);
            border: 1px solid var(--gris-border);
            border-radius: 16px;
            padding: 40px;
        }

        .step { display: none; }
        .step.active { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .step-title { font-size: 1.4rem; font-weight: 600; margin-bottom: 10px; color: var(--blanc); }
        .step-title span { color: var(--vert); }
        .step-subtitle { font-size: 0.95rem; color: var(--gris-text); margin-bottom: 25px; line-height: 1.5; }

        .guide-box {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid var(--bleu); border-left: 4px solid var(--bleu);
            border-radius: 8px; padding: 16px 20px; margin-bottom: 24px;
        }
        .guide-box-title { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; font-weight: 600; color: var(--bleu); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px; }
        .guide-box ul { list-style: none; padding: 0; margin: 0; }
        .guide-box li { font-size: 0.9rem; color: var(--gris-text); padding: 6px 0 6px 20px; position: relative; }
        .guide-box li::before { content: "‚Üí"; position: absolute; left: 0; color: var(--bleu); }

        .context-box {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid var(--jaune); border-left: 4px solid var(--jaune);
            border-radius: 8px; padding: 14px 18px; margin-bottom: 20px;
            font-size: 0.85rem; color: var(--gris-text);
        }
        .context-box strong { color: var(--jaune); }

        .form-group { margin-bottom: 24px; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .form-row-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; }
        @media (max-width: 700px) { .form-row, .form-row-3 { grid-template-columns: 1fr; } }

        label { display: block; font-size: 0.9rem; font-weight: 500; color: var(--gris-text); margin-bottom: 8px; }
        label .required { color: var(--vert); }

        input[type="text"], input[type="email"], input[type="tel"], input[type="number"], select, textarea {
            width: 100%; padding: 14px 16px;
            background: var(--noir-input); border: 1px solid var(--gris-border);
            border-radius: 10px; color: var(--blanc); font-size: 1rem;
            font-family: inherit; transition: all 0.2s ease;
        }
        input:focus, select:focus, textarea:focus { outline: none; border-color: var(--vert); box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.3); }
        input::placeholder, textarea::placeholder { color: var(--gris-text); opacity: 0.6; }

        select {
            cursor: pointer; appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23A0A0B2' stroke-width='2'%3E%3Cpolyline points='6,9 12,15 18,9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat; background-position: right 12px center; background-size: 18px; padding-right: 40px;
        }

        textarea { resize: vertical; min-height: 80px; }
        textarea.notes { background: rgba(139, 92, 246, 0.05); border: 1px dashed var(--violet-primary); min-height: 100px; }
        textarea.notes::placeholder { color: var(--violet-primary); opacity: 0.5; }
        .notes-label { display: flex; align-items: center; gap: 8px; color: var(--violet-primary); }
        .notes-label::before { content: "üìù"; }

        .slider-container { margin-top: 10px; }
        .slider-labels { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 0.75rem; color: var(--gris-text); }
        input[type="range"] { width: 100%; height: 8px; background: var(--noir-input); border-radius: 4px; outline: none; -webkit-appearance: none; }
        input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; width: 24px; height: 24px; background: var(--vert); border-radius: 50%; cursor: pointer; box-shadow: 0 0 10px rgba(16, 185, 129, 0.4); }
        .slider-value { text-align: center; margin-top: 12px; font-size: 2rem; font-weight: 700; color: var(--vert); }
        .slider-description { text-align: center; margin-top: 8px; font-size: 0.9rem; color: var(--gris-text); }

        .checkbox-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-top: 10px; }
        @media (max-width: 600px) { .checkbox-grid { grid-template-columns: 1fr; } }
        .checkbox-item { display: flex; align-items: center; padding: 12px 16px; background: var(--noir-input); border: 1px solid var(--gris-border); border-radius: 10px; cursor: pointer; transition: all 0.2s ease; }
        .checkbox-item:hover { border-color: var(--vert); }
        .checkbox-item.selected { border-color: var(--vert); background: rgba(16, 185, 129, 0.1); }
        .checkbox-item input { display: none; }
        .checkbox-custom { width: 20px; height: 20px; border: 2px solid var(--gris-border); border-radius: 4px; margin-right: 12px; display: flex; align-items: center; justify-content: center; transition: all 0.2s ease; flex-shrink: 0; }
        .checkbox-item.selected .checkbox-custom { background: var(--vert); border-color: var(--vert); }
        .checkbox-custom::after { content: "‚úì"; color: white; font-size: 12px; font-weight: bold; opacity: 0; transition: opacity 0.2s ease; }
        .checkbox-item.selected .checkbox-custom::after { opacity: 1; }
        .checkbox-label { font-size: 0.85rem; color: var(--blanc); }

        .tools-count { text-align: center; margin-top: 16px; padding: 14px; background: var(--noir-input); border-radius: 10px; font-size: 1rem; }
        .tools-count strong { color: var(--vert); font-size: 1.3rem; }
        .tools-count .risk-label { display: block; margin-top: 6px; font-size: 0.85rem; }
        .tools-count .risk-low { color: var(--vert); }
        .tools-count .risk-medium { color: var(--jaune); }
        .tools-count .risk-high { color: var(--rouge); }

        .section-divider { border: none; border-top: 1px solid var(--gris-border); margin: 30px 0; }

        .btn-container { display: flex; gap: 16px; margin-top: 30px; }
        .btn { flex: 1; padding: 16px 24px; border: none; border-radius: 10px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.2s ease; font-family: inherit; }
        .btn-secondary { background: var(--noir-input); color: var(--gris-text); border: 1px solid var(--gris-border); }
        .btn-secondary:hover { background: var(--gris-border); color: var(--blanc); }
        .btn-primary { background: linear-gradient(135deg, #059669, var(--vert)); color: var(--blanc); box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3); }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4); }
        .btn-primary:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

        .form-group.error input, .form-group.error select, .form-group.error textarea { border-color: var(--rouge); box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.2); }
        .form-group.error label { color: var(--rouge); }
        .error-message { color: var(--rouge); font-size: 0.8rem; margin-top: 6px; display: none; }
        .form-group.error .error-message { display: block; }

        .loading, .success-message, .error-message-box { display: none; text-align: center; padding: 40px; }
        .loading.active, .success-message.active, .error-message-box.active { display: block; }
        .spinner { width: 50px; height: 50px; border: 3px solid var(--gris-border); border-top-color: var(--vert); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 20px; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .success-icon { width: 80px; height: 80px; background: var(--vert); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; font-size: 2rem; }
        .error-icon { width: 80px; height: 80px; background: var(--rouge); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; font-size: 2rem; }
        .success-message h2 { color: var(--blanc); margin-bottom: 12px; }
        .success-message p { color: var(--gris-text); }
        .error-message-box h2 { color: var(--rouge); margin-bottom: 12px; }

        .roi-breakdown { background: var(--noir-input); border-radius: 10px; padding: 20px; margin: 20px 0; text-align: left; }
        .roi-line { display: flex; justify-content: space-between; padding: 8px 0; font-size: 0.95rem; color: var(--gris-text); }
        .roi-line.total { border-top: 1px solid var(--gris-border); margin-top: 10px; padding-top: 15px; font-weight: 600; color: var(--blanc); }
        .roi-line .value { color: var(--vert); font-weight: 500; }
        .roi-line.total .value { font-size: 1.2rem; }

        .calcul-detail { background: rgba(139, 92, 246, 0.1); border: 1px dashed var(--violet-primary); border-radius: 8px; padding: 12px 16px; margin: 10px 0; font-family: monospace; font-size: 0.75rem; color: var(--violet-primary); }

        .hp-field { position: absolute; left: -9999px; top: -9999px; opacity: 0; pointer-events: none; }

        .cookie-banner {
            position: fixed; bottom: 0; left: 0; right: 0;
            background: rgba(26, 26, 46, 0.98); border-top: 1px solid var(--vert);
            padding: 16px 24px; display: flex; justify-content: space-between;
            align-items: center; gap: 20px; z-index: 9999;
            backdrop-filter: blur(10px); box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
        }
        .cookie-banner.hidden { display: none; }
        .cookie-text { color: var(--gris-text); font-size: 0.9rem; flex: 1; }
        .cookie-text a { color: var(--vert); text-decoration: underline; }
        .cookie-buttons { display: flex; gap: 12px; flex-shrink: 0; }
        .cookie-btn { padding: 10px 20px; border-radius: 8px; font-size: 0.85rem; font-weight: 600; cursor: pointer; transition: all 0.2s ease; border: none; font-family: inherit; }
        .cookie-btn-accept { background: linear-gradient(135deg, #059669, var(--vert)); color: white; }
        .cookie-btn-accept:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4); }
        .cookie-btn-link { background: transparent; color: var(--vert); border: 1px solid var(--vert); }
        .cookie-btn-link:hover { background: rgba(16, 185, 129, 0.1); }
        @media (max-width: 600px) { .cookie-banner { flex-direction: column; text-align: center; } .cookie-buttons { width: 100%; justify-content: center; } }
    </style>
</head>
<body>
    <div class="cookie-banner" id="cookieBanner">
        <span class="cookie-text">üç™ Ce site utilise des cookies. <a href="https://www.kanso-ops.com/privacy-policy" target="_blank">Politique de confidentialit√©</a>.</span>
        <div class="cookie-buttons">
            <button class="cookie-btn cookie-btn-link" onclick="window.open('https://www.kanso-ops.com/privacy-policy', '_blank')">En savoir plus</button>
            <button class="cookie-btn cookie-btn-accept" onclick="acceptCookies()">Accepter</button>
        </div>
    </div>

    <div class="container">
        <header class="header">
            <div class="badge">ü§ù Entretien Client</div>
            <h1>Audit Kanso 360</h1>
            <p>Outil de conduite d'entretien ‚Äî Diagnostic en live</p>
        </header>

        <div class="timer-bar">
            <div><span class="timer-label">Dur√©e</span> <span class="timer">20-30 min</span></div>
            <div><span class="timer-label">√âtape</span> <span class="timer"><span id="currentStep">1</span> / 7</span></div>
        </div>

        <div class="progress-container">
            <div class="progress-bar"><div class="progress-fill" id="progressFill" style="width: 14%"></div></div>
        </div>

        <div class="form-card">
            <form id="auditForm">
                <div class="hp-field"><label for="website">Website</label><input type="text" name="website" id="website" tabindex="-1" autocomplete="off"></div>

                <!-- √âTAPE 1 -->
                <div class="step active" data-step="1">
                    <h2 class="step-title"><span>01.</span> Identit√© & Contexte</h2>
                    <p class="step-subtitle">Cr√©ez le lien et comprenez le contexte.</p>
                    <div class="guide-box">
                        <div class="guide-box-title">üí° Guide Consultant</div>
                        <ul>
                            <li>"Comment avez-vous connu Kanso-Ops ?"</li>
                            <li>"Qu'est-ce qui vous a motiv√© √† demander cet audit ?"</li>
                        </ul>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>Pr√©nom <span class="required">*</span></label><input type="text" name="first_name" placeholder="Jean" required></div>
                        <div class="form-group"><label>Nom <span class="required">*</span></label><input type="text" name="last_name" placeholder="Dupont" required></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>Email professionnel <span class="required">*</span></label><input type="email" name="email" placeholder="vous@entreprise.com" required></div>
                        <div class="form-group"><label>T√©l√©phone</label><input type="tel" name="phone" placeholder="+33 6 12 34 56 78"></div>
                    </div>
                    <hr class="section-divider">
                    <div class="form-group"><label class="notes-label">Notes de contexte</label><textarea class="notes" name="notes_contexte" placeholder="Ex: Reco de X, changement d'ERP pr√©vu..."></textarea></div>
                    <div class="btn-container"><button type="button" class="btn btn-primary" onclick="nextStep()">Continuer ‚Üí</button></div>
                </div>

                <!-- √âTAPE 2 -->
                <div class="step" data-step="2">
                    <h2 class="step-title"><span>02.</span> L'Entreprise</h2>
                    <p class="step-subtitle">Contexte business et taille.</p>
                    <div class="guide-box">
                        <div class="guide-box-title">üí° Guide</div>
                        <ul><li>"Pr√©sentez-moi votre entreprise"</li><li>"Combien de personnes ?"</li></ul>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>Entreprise <span class="required">*</span></label><input type="text" name="company_name" placeholder="Entreprise SAS" required></div>
                        <div class="form-group"><label>Fonction <span class="required">*</span></label>
                            <select name="job_title" required>
                                <option value="">S√©lectionnez...</option>
                                <option value="DAF">DAF / Directeur Financier</option>
                                <option value="RAF">RAF / Responsable Administratif</option>
                                <option value="Directeur Achats">Directeur Achats</option>
                                <option value="Responsable Achats">Responsable Achats</option>
                                <option value="Supply Chain Manager">Supply Chain Manager</option>
                                <option value="DG / CEO">DG / CEO</option>
                                <option value="DSI / CTO">DSI / CTO</option>
                                <option value="Autre">Autre</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>Secteur <span class="required">*</span></label>
                            <select name="industry" required>
                                <option value="">S√©lectionnez...</option>
                                <option value="Industrie manufacturi√®re">Industrie manufacturi√®re</option>
                                <option value="Agroalimentaire">Agroalimentaire</option>
                                <option value="Chimie / Pharma">Chimie / Pharma</option>
                                <option value="Automobile / A√©ronautique">Auto / A√©ro</option>
                                <option value="BTP / Construction">BTP</option>
                                <option value="Distribution / Retail">Distribution</option>
                                <option value="Services B2B">Services B2B</option>
                                <option value="Tech / SaaS">Tech / SaaS</option>
                                <option value="Autre">Autre</option>
                            </select>
                        </div>
                        <div class="form-group"><label>Taille <span class="required">*</span></label>
                            <select name="company_size" required>
                                <option value="">S√©lectionnez...</option>
                                <option value="10-50">10-50 salari√©s</option>
                                <option value="51-200">51-200 salari√©s</option>
                                <option value="201-500">201-500 salari√©s</option>
                                <option value="501-1000">501-1000 salari√©s</option>
                                <option value="> 1000">> 1000 salari√©s</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group"><label>CA approximatif</label>
                        <select name="revenue">
                            <option value="">Non communiqu√©</option>
                            <option value="< 10M‚Ç¨">< 10M‚Ç¨</option>
                            <option value="10-50M‚Ç¨">10-50M‚Ç¨</option>
                            <option value="50-100M‚Ç¨">50-100M‚Ç¨</option>
                            <option value="100-500M‚Ç¨">100-500M‚Ç¨</option>
                            <option value="> 500M‚Ç¨">> 500M‚Ç¨</option>
                        </select>
                    </div>
                    <hr class="section-divider">
                    <div class="form-group"><label class="notes-label">Notes entreprise</label><textarea class="notes" name="notes_entreprise" placeholder="Ex: Filiale groupe, croissance externe..."></textarea></div>
                    <div class="btn-container">
                        <button type="button" class="btn btn-secondary" onclick="prevStep()">‚Üê Retour</button>
                        <button type="button" class="btn btn-primary" onclick="nextStep()">Continuer ‚Üí</button>
                    </div>
                </div>

                <!-- √âTAPE 3 -->
                <div class="step" data-step="3">
                    <h2 class="step-title"><span>03.</span> √âcosyst√®me Tech</h2>
                    <p class="step-subtitle">Maturit√© digitale et contraintes d'int√©gration.</p>
                    <div class="guide-box">
                        <div class="guide-box-title">üí° Guide</div>
                        <ul><li>"Quel ERP utilisez-vous ?"</li><li>"√Ä quel point l'exploitez-vous ?"</li></ul>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>ERP principal <span class="required">*</span></label>
                            <select name="erp" required>
                                <option value="">S√©lectionnez...</option>
                                <option value="SAP">SAP</option>
                                <option value="Oracle">Oracle</option>
                                <option value="Sage">Sage (X3, 100...)</option>
                                <option value="Cegid">Cegid</option>
                                <option value="Microsoft Dynamics">Microsoft Dynamics</option>
                                <option value="Odoo">Odoo</option>
                                <option value="ERP M√©tier">ERP M√©tier</option>
                                <option value="Excel / Pas d'ERP">Excel / Pas d'ERP</option>
                                <option value="Autre">Autre</option>
                            </select>
                        </div>
                        <div class="form-group"><label>Pr√©cision ERP</label><input type="text" name="erp_detail" placeholder="Ex: SAP S/4HANA..."></div>
                    </div>
                    <div class="form-group">
                        <label>Exploitation ERP <span class="required">*</span></label>
                        <div class="slider-container">
                            <div class="slider-labels"><span>1 ‚Äî Basique</span><span>10 ‚Äî Cockpit central</span></div>
                            <input type="range" name="erp_mastery" min="1" max="10" value="5" id="erpSlider">
                            <div class="slider-value" id="erpValue">5</div>
                            <div class="slider-description" id="erpDescription">Partiel ‚Äî Excel √† c√¥t√©</div>
                        </div>
                    </div>
                    <hr class="section-divider">
                    <div class="form-group"><label class="notes-label">Notes ERP</label><textarea class="notes" name="notes_erp" placeholder="Ex: SAP depuis 2015, 3 modules utilis√©s..."></textarea></div>
                    <div class="btn-container">
                        <button type="button" class="btn btn-secondary" onclick="prevStep()">‚Üê Retour</button>
                        <button type="button" class="btn btn-primary" onclick="nextStep()">Continuer ‚Üí</button>
                    </div>
                </div>

                <!-- √âTAPE 4 -->
                <div class="step" data-step="4">
                    <h2 class="step-title"><span>04.</span> Fragmentation Outils</h2>
                    <p class="step-subtitle">Plus d'outils = donn√©es √©clat√©es.</p>
                    <div class="guide-box">
                        <div class="guide-box-title">üí° Guide</div>
                        <ul><li>"Quels outils en dehors de l'ERP ?"</li><li>"Combien de ressaisies ?"</li></ul>
                    </div>
                    <div class="form-group">
                        <label>Outils en plus de l'ERP</label>
                        <div class="checkbox-grid" id="toolsGrid">
                            <label class="checkbox-item"><input type="checkbox" name="tools_used" value="Notes de frais (N2F, Concur...)"><span class="checkbox-custom"></span><span class="checkbox-label">Notes de frais</span></label>
                            <label class="checkbox-item"><input type="checkbox" name="tools_used" value="Procurement (Coupa, Ivalua...)"><span class="checkbox-custom"></span><span class="checkbox-label">Procurement</span></label>
                            <label class="checkbox-item"><input type="checkbox" name="tools_used" value="Conformit√© (Provigis, E-attestation...)"><span class="checkbox-custom"></span><span class="checkbox-label">Conformit√©</span></label>
                            <label class="checkbox-item"><input type="checkbox" name="tools_used" value="CRM (Salesforce, HubSpot...)"><span class="checkbox-custom"></span><span class="checkbox-label">CRM</span></label>
                            <label class="checkbox-item"><input type="checkbox" name="tools_used" value="Gestion projet (Monday, Asana...)"><span class="checkbox-custom"></span><span class="checkbox-label">Gestion projet</span></label>
                            <label class="checkbox-item"><input type="checkbox" name="tools_used" value="Signature (DocuSign, Yousign...)"><span class="checkbox-custom"></span><span class="checkbox-label">Signature</span></label>
                            <label class="checkbox-item"><input type="checkbox" name="tools_used" value="GED (SharePoint, Drive...)"><span class="checkbox-custom"></span><span class="checkbox-label">GED</span></label>
                            <label class="checkbox-item"><input type="checkbox" name="tools_used" value="BI (Power BI, Tableau...)"><span class="checkbox-custom"></span><span class="checkbox-label">BI</span></label>
                            <label class="checkbox-item"><input type="checkbox" name="tools_used" value="Excel intensif"><span class="checkbox-custom"></span><span class="checkbox-label">Excel intensif</span></label>
                            <label class="checkbox-item"><input type="checkbox" name="tools_used" value="Autres outils m√©tiers"><span class="checkbox-custom"></span><span class="checkbox-label">Autres</span></label>
                        </div>
                        <div class="tools-count" id="toolsCount"><strong>1</strong> outil (ERP seul)<span class="risk-label risk-low">‚úì Centralis√©</span></div>
                    </div>
                    <div class="form-group"><label>Autres outils</label><input type="text" name="tools_other" placeholder="Ex: Divalto, outil maison..."></div>
                    <hr class="section-divider">
                    <div class="form-group"><label class="notes-label">Notes fragmentation</label><textarea class="notes" name="notes_fragmentation" placeholder="Ex: Excel = la glue..."></textarea></div>
                    <div class="btn-container">
                        <button type="button" class="btn btn-secondary" onclick="prevStep()">‚Üê Retour</button>
                        <button type="button" class="btn btn-primary" onclick="nextStep()">Continuer ‚Üí</button>
                    </div>
                </div>

                <!-- √âTAPE 5 - ROI -->
                <div class="step" data-step="5">
                    <h2 class="step-title"><span>05.</span> √âquipe & Charge</h2>
                    <p class="step-subtitle">Quantifier le probl√®me pour calculer le ROI.</p>
                    <div class="guide-box">
                        <div class="guide-box-title">üí° Guide</div>
                        <ul>
                            <li>"Combien de personnes concern√©es ?"</li>
                            <li>"Combien de temps admin par jour ?"</li>
                        </ul>
                    </div>
                    <div class="context-box">
                        <strong>üí∞ Formule ROI :</strong> √âquipe √ó Heures/jour √ó Taux √ó 235j + Fournisseurs √ó 10‚Ç¨ √ó Facteur risque
                    </div>
                    <div class="form-row-3">
                        <div class="form-group"><label>√âquipe impact√©e <span class="required">*</span></label>
                            <select name="team_size" required>
                                <option value="">S√©lectionnez...</option>
                                <option value="1">1 personne</option>
                                <option value="2">2 personnes</option>
                                <option value="4">3-5 personnes</option>
                                <option value="8">6-10 personnes</option>
                                <option value="15">11-20 personnes</option>
                                <option value="30">20+ personnes</option>
                            </select>
                        </div>
                        <div class="form-group"><label>Temps admin/JOUR <span class="required">*</span></label>
                            <select name="hours_lost" required>
                                <option value="">S√©lectionnez...</option>
                                <option value="0.5">< 30 min</option>
                                <option value="1">~1h</option>
                                <option value="2">~2h</option>
                                <option value="3.5">3-4h</option>
                                <option value="5">> 4h</option>
                            </select>
                        </div>
                        <div class="form-group"><label>Fournisseurs actifs <span class="required">*</span></label>
                            <select name="data_volume" required>
                                <option value="">S√©lectionnez...</option>
                                <option value="25">< 50</option>
                                <option value="75">50-100</option>
                                <option value="300">100-500</option>
                                <option value="750">500-1000</option>
                                <option value="1500">1000-2000</option>
                                <option value="3000">> 2000</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group"><label>Fiabilit√© base fournisseurs <span class="required">*</span></label>
                        <select name="data_confidence" required>
                            <option value="">S√©lectionnez...</option>
                            <option value="fiable">Fiable ‚Äî R√©f√©rentiel unique</option>
                            <option value="partielle">Partielle ‚Äî Doublons/obsol√®tes</option>
                            <option value="non_maitrisee">Non ma√Ætris√©e ‚Äî Chacun son Excel</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Co√ªt horaire charg√© <span class="required">*</span></label>
                        <p style="font-size: 0.8rem; color: var(--gris-text); margin-bottom: 12px;">D√©faut: 42‚Ç¨/h (technicien/gestionnaire)</p>
                        <div class="slider-container">
                            <div class="slider-labels"><span>25‚Ç¨ (Junior)</span><span>60‚Ç¨ (Direction)</span></div>
                            <input type="range" id="tauxHoraireSlider" name="taux_horaire" min="25" max="60" value="42" step="1" required>
                            <div class="slider-value"><span id="tauxHoraireValue">42</span>‚Ç¨/h</div>
                            <div class="slider-description" id="tauxHoraireDescription">Technicien / Gestionnaire</div>
                        </div>
                    </div>
                    <hr class="section-divider">
                    <div class="form-group"><label class="notes-label">Notes √©quipe</label><textarea class="notes" name="notes_equipe" placeholder="Ex: Marie passe 3h/jour sur les factures..."></textarea></div>
                    <div class="btn-container">
                        <button type="button" class="btn btn-secondary" onclick="prevStep()">‚Üê Retour</button>
                        <button type="button" class="btn btn-primary" onclick="nextStep()">Continuer ‚Üí</button>
                    </div>
                </div>

                <!-- √âTAPE 6 -->
                <div class="step" data-step="6">
                    <h2 class="step-title"><span>06.</span> Les Douleurs</h2>
                    <p class="step-subtitle">Pain point principal et impact business.</p>
                    <div class="guide-box">
                        <div class="guide-box-title">üí° Guide</div>
                        <ul><li>"Si vous changiez UNE chose ?"</li><li>"Impact business ?"</li></ul>
                    </div>
                    <div class="form-group"><label>Process douloureux <span class="required">*</span></label>
                        <select name="pain_point" required>
                            <option value="">S√©lectionnez...</option>
                            <option value="sales_order">SAISIE COMMANDES (ADV)</option>
                            <option value="finance_invoice">LITIGES PRIX/FACTURES</option>
                            <option value="supply_arc">RELANCE FOURNISSEURS</option>
                            <option value="quality_doc">QUALIT√â/CERTIFICATS</option>
                            <option value="other_custom">AUTRE PROCESSUS</option>
                        </select>
                    </div>
                    <div class="form-group"><label>Description</label><textarea name="pain_detail" placeholder="D√©crivez le probl√®me..."></textarea></div>
                    <div class="form-group"><label>Baguette magique ?</label><textarea name="dream_feature" placeholder="Que changeriez-vous ?"></textarea></div>
                    <hr class="section-divider">
                    <div class="form-group"><label class="notes-label">Notes douleurs</label><textarea class="notes" name="notes_douleurs" placeholder="Ex: 15K‚Ç¨ perdus sur litige X..."></textarea></div>
                    <div class="btn-container">
                        <button type="button" class="btn btn-secondary" onclick="prevStep()">‚Üê Retour</button>
                        <button type="button" class="btn btn-primary" onclick="nextStep()">Continuer ‚Üí</button>
                    </div>
                </div>

                <!-- √âTAPE 7 -->
                <div class="step" data-step="7">
                    <h2 class="step-title"><span>07.</span> D√©cision & Next Steps</h2>
                    <p class="step-subtitle">Circuit de d√©cision et prochaines √©tapes.</p>
                    <div class="guide-box">
                        <div class="guide-box-title">üí° Guide</div>
                        <ul><li>"Qui d'autre impliqu√© ?"</li><li>"Budget pr√©vu ?"</li><li>"Timing id√©al ?"</li></ul>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>Timeline <span class="required">*</span></label>
                            <select name="timeline" required>
                                <option value="">S√©lectionnez...</option>
                                <option value="Imm√©diat (< 1 mois)">Imm√©diat</option>
                                <option value="Court terme (1-3 mois)">1-3 mois</option>
                                <option value="Moyen terme (3-6 mois)">3-6 mois</option>
                                <option value="Long terme (6+ mois)">6+ mois</option>
                                <option value="Exploration">Exploration</option>
                            </select>
                        </div>
                        <div class="form-group"><label>Niveau d√©cision <span class="required">*</span></label>
                            <select name="decision_level" required>
                                <option value="">S√©lectionnez...</option>
                                <option value="D√©cideur final">D√©cideur final</option>
                                <option value="Influence forte">Influence forte</option>
                                <option value="Prescripteur">Prescripteur</option>
                                <option value="Explorateur">Explorateur</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group"><label>Budget</label>
                            <select name="budget">
                                <option value="">Non d√©fini</option>
                                <option value="< 5K‚Ç¨">< 5K‚Ç¨</option>
                                <option value="5-15K‚Ç¨">5-15K‚Ç¨</option>
                                <option value="15-30K‚Ç¨">15-30K‚Ç¨</option>
                                <option value="30-50K‚Ç¨">30-50K‚Ç¨</option>
                                <option value="> 50K‚Ç¨">> 50K‚Ç¨</option>
                            </select>
                        </div>
                        <div class="form-group"><label>Prochaine √©tape</label>
                            <select name="next_step">
                                <option value="">S√©lectionnez...</option>
                                <option value="D√©mo personnalis√©e">D√©mo</option>
                                <option value="Proposition commerciale">Proposition</option>
                                <option value="RDV avec d√©cideur">RDV d√©cideur</option>
                                <option value="POC / Pilote">POC</option>
                                <option value="Documentation">Doc</option>
                                <option value="Recontact ult√©rieur">Recontact</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group"><label>Autres d√©cideurs</label><input type="text" name="other_stakeholders" placeholder="Ex: DAF, DSI, DG..."></div>
                    <div class="form-group"><label>Prochaines √©tapes</label><textarea name="next_steps" placeholder="Ex: Rapport 24h, call vendredi..."></textarea></div>
                    <hr class="section-divider">
                    <div class="form-group"><label class="notes-label">Notes finales</label><textarea class="notes" name="notes_final" placeholder="Ex: Lead qualifi√©, DSI √† convaincre..."></textarea></div>
                    <input type="hidden" name="source" value="client">
                    <input type="hidden" name="submitted_at" id="submittedAt">
                    <div class="btn-container">
                        <button type="button" class="btn btn-secondary" onclick="prevStep()">‚Üê Retour</button>
                        <button type="submit" class="btn btn-primary">G√©n√©rer le diagnostic ‚Üí</button>
                    </div>
                </div>

                <!-- Loading -->
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>G√©n√©ration du rapport...</p>
                </div>

                <!-- Success -->
                <div class="success-message" id="success">
                    <div class="success-icon">‚úì</div>
                    <h2>Merci !</h2>
                    <p style="font-size: 1.1rem; margin-bottom: 10px;">Co√ªt annuel identifi√© :</p>
                    <div class="roi-breakdown">
                        <div class="roi-line"><span>Co√ªt de productivit√© perdue</span><span class="value" id="roiProductivite">0 ‚Ç¨</span></div>
                        <div class="roi-line"><span>Co√ªt de non-qualit√© data</span><span class="value" id="roiNonQualite">0 ‚Ç¨</span></div>
                        <div class="roi-line total"><span>TOTAL R√âCUP√âRABLE</span><span class="value" id="roiTotal">0 ‚Ç¨</span></div>
                    </div>
                    <div class="calcul-detail" id="calculDetail"></div>
                    <p style="margin-top: 20px;">Rapport PDF sous <strong style="color: var(--blanc);">24h</strong>.</p>
                    <p style="margin-top: 10px; color: var(--vert);">üìß <span id="clientEmail"></span></p>
                </div>

                <!-- Error -->
                <div class="error-message-box" id="errorBox">
                    <div class="error-icon">‚úó</div>
                    <h2>Erreur</h2>
                    <p style="margin-bottom: 20px;">V√©rifiez votre connexion.</p>
                    <button type="button" class="btn btn-primary" onclick="retrySubmit()" style="max-width: 300px; margin: 0 auto;">R√©essayer ‚Üí</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        let currentStep = 1;
        const totalSteps = 7;
        let lastFormData = null;

        function nextStep() {
            if (!validateStep(currentStep)) return;
            if (currentStep < totalSteps) {
                document.querySelector("[data-step='" + currentStep + "']").classList.remove('active');
                currentStep++;
                document.querySelector("[data-step='" + currentStep + "']").classList.add('active');
                updateProgress();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                document.querySelector("[data-step='" + currentStep + "']").classList.remove('active');
                currentStep--;
                document.querySelector("[data-step='" + currentStep + "']").classList.add('active');
                updateProgress();
            }
        }

        function updateProgress() {
            document.getElementById('progressFill').style.width = (currentStep / totalSteps * 100) + "%";
            document.getElementById('currentStep').textContent = currentStep;
        }

        function validateStep(step) {
            const stepEl = document.querySelector("[data-step='" + step + "']");
            const inputs = stepEl.querySelectorAll('input[required], select[required]');
            let isValid = true;
            inputs.forEach(input => {
                const fg = input.closest('.form-group');
                if (!input.value.trim()) { fg.classList.add('error'); isValid = false; }
                else { fg.classList.remove('error'); }
            });
            return isValid;
        }

        // ERP Slider
        const erpSlider = document.getElementById('erpSlider');
        const erpValue = document.getElementById('erpValue');
        const erpDescription = document.getElementById('erpDescription');
        const erpDesc = { 1: "Tr√®s basique", 2: "Tr√®s basique", 3: "Basique", 4: "Basique + Excel", 5: "Partiel ‚Äî Excel √† c√¥t√©", 6: "Partiel", 7: "Avanc√©", 8: "Avanc√©", 9: "Cockpit central", 10: "Source unique" };
        erpSlider.addEventListener('input', function() { erpValue.textContent = this.value; erpDescription.textContent = erpDesc[this.value]; });

        // Taux Slider
        const tauxSlider = document.getElementById('tauxHoraireSlider');
        const tauxValue = document.getElementById('tauxHoraireValue');
        const tauxDesc = document.getElementById('tauxHoraireDescription');
        const getTauxDesc = (t) => t < 30 ? "Junior" : t < 35 ? "Administratif" : t < 40 ? "Standard" : t < 45 ? "Technicien" : t < 50 ? "Cadre" : t < 55 ? "Cadre confirm√©" : "Direction";
        tauxSlider.addEventListener('input', function() { tauxValue.textContent = this.value; tauxDesc.textContent = getTauxDesc(parseInt(this.value)); });

        // Checkboxes
        document.querySelectorAll('.checkbox-item').forEach(item => {
            item.addEventListener('click', function() {
                const cb = this.querySelector('input[type="checkbox"]');
                cb.checked = !cb.checked;
                this.classList.toggle('selected', cb.checked);
                updateToolsCount();
            });
        });

        function updateToolsCount() {
            const checked = document.querySelectorAll('.checkbox-item.selected').length;
            const total = checked + 1;
            const el = document.getElementById('toolsCount');
            let risk = 'risk-low', txt = '‚úì Centralis√©';
            if (total >= 4 && total <= 6) { risk = 'risk-medium'; txt = '‚ö† Fragmentation mod√©r√©e'; }
            else if (total >= 7) { risk = 'risk-high'; txt = 'üî¥ Fragmentation √©lev√©e'; }
            el.innerHTML = "<strong>" + total + "</strong> outil" + (total > 1 ? "s" : "") + "<span class='risk-label " + risk + "'>" + txt + "</span>";
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // üîß v10: CALCUL ROI IDENTIQUE AU PDF
        // Formule PDF: team √ó hours √ó taux √ó 235 + fournisseurs √ó 10 √ó facteur
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function calculateROI(data) {
            const teamSize = parseInt(data.team_size) || 1;
            const dailyHours = parseFloat(data.hours_lost) || 1;
            const tauxHoraire = parseInt(data.taux_horaire) || 42;
            const dataVolume = parseInt(data.data_volume) || 100;
            const dataConfidence = data.data_confidence || 'partielle';
            
            // Facteur risque
            let riskFactor = 0.5; // Partielle
            if (dataConfidence === 'fiable') riskFactor = 0.2;
            if (dataConfidence === 'non_maitrisee') riskFactor = 1.0;
            
            // Calculs identiques au PDF
            const coutProductivite = Math.round(teamSize * dailyHours * tauxHoraire * 235);
            const coutNonQualite = Math.round(dataVolume * 10 * riskFactor);
            const total = coutProductivite + coutNonQualite;

            console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
            console.log('[ROI v10] team:', teamSize, '√ó hours:', dailyHours, '√ó taux:', tauxHoraire, '√ó 235 =', coutProductivite);
            console.log('[ROI v10] fournisseurs:', dataVolume, '√ó 10 √ó factor:', riskFactor, '=', coutNonQualite);
            console.log('[ROI v10] TOTAL:', total);
            console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');

            return { productivite: coutProductivite, nonQualite: coutNonQualite, total: total,
                debug: { teamSize, dailyHours, tauxHoraire, dataVolume, riskFactor } };
        }

        async function submitData(data) {
            const response = await fetch('https://kanso-client1-u62809.vm.elestio.app/webhook/48b9776e-cd0d-472d-8b66-c01fa567cce2', {
                method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data)
            });
            if (!response.ok) throw new Error('HTTP ' + response.status);
            return response;
        }

        function showSuccess(data) {
            const roi = calculateROI(data);
            document.getElementById('loading').classList.remove('active');
            document.getElementById('errorBox').classList.remove('active');
            document.getElementById('success').classList.add('active');
            document.getElementById('clientEmail').textContent = data.email;
            document.getElementById('roiProductivite').textContent = roi.productivite.toLocaleString('fr-FR') + ' ‚Ç¨';
            document.getElementById('roiNonQualite').textContent = roi.nonQualite.toLocaleString('fr-FR') + ' ‚Ç¨';
            document.getElementById('roiTotal').textContent = roi.total.toLocaleString('fr-FR') + ' ‚Ç¨/an';
            const d = roi.debug;
            document.getElementById('calculDetail').innerHTML = 
                'Productivit√©: ' + d.teamSize + ' √ó ' + d.dailyHours + 'h √ó ' + d.tauxHoraire + '‚Ç¨ √ó 235j = ' + roi.productivite.toLocaleString('fr-FR') + '‚Ç¨<br>' +
                'Non-qualit√©: ' + d.dataVolume + ' √ó 10‚Ç¨ √ó ' + d.riskFactor + ' = ' + roi.nonQualite.toLocaleString('fr-FR') + '‚Ç¨';
        }

        function showError() {
            document.getElementById('loading').classList.remove('active');
            document.getElementById('success').classList.remove('active');
            document.getElementById('errorBox').classList.add('active');
        }

        function retrySubmit() {
            if (lastFormData) {
                document.getElementById('errorBox').classList.remove('active');
                document.getElementById('loading').classList.add('active');
                submitData(lastFormData).then(() => showSuccess(lastFormData)).catch(() => showError());
            }
        }

        document.getElementById('auditForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            if (document.getElementById('website').value !== '') {
                document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
                document.getElementById('success').classList.add('active');
                return;
            }
            if (!validateStep(currentStep)) return;

            document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
            document.getElementById('loading').classList.add('active');

            const formData = new FormData(this);
            const data = {};
            const toolsUsed = [];
            document.querySelectorAll('input[name="tools_used"]:checked').forEach(cb => toolsUsed.push(cb.value));
            formData.forEach((value, key) => { if (key !== 'tools_used' && key !== 'website') data[key] = value; });
            data.tools_used = toolsUsed;
            data.submitted_at = new Date().toISOString();
            lastFormData = data;

            console.log('[Audit v10] Donn√©es:', data);

            try {
                await submitData(data);
                showSuccess(data);
            } catch (error) {
                console.error('[Audit] Erreur:', error);
                showError();
            }
        });

        function acceptCookies() { localStorage.setItem('kanso_cookies_accepted', 'true'); document.getElementById('cookieBanner').classList.add('hidden'); }
        if (localStorage.getItem('kanso_cookies_accepted') === 'true') document.getElementById('cookieBanner').classList.add('hidden');
    </script>
</body>
</html>
